# README_ru.md (Russian)

[English version](./README.md)

---

# Go Honeypot — краткое описание

Лёгковесный honeypot на Go для сбора телеметрии о сканерах и простых автоматизированных атаках. Проект предоставляет базовую активную прослушку TCP/UDP, пассивный pcap-сниффинг и эвристическую детекцию подозрительной активности. Входящие payload'ы не исполняются — выполняется только анализ и хеширование.

---

## Преимущества

- **Простота развёртывания**: один бинарник, минимум зависимостей.
- **Гибридный сбор телеметрии**: сочетание активной прослушки и пассивного сниффинга даёт больший охват наблюдения.
- **Безопасный дизайн**: не выполняет код, обрезает большие payload'ы, проверяет по сигнатурам.
- **Сосуществование с реальными сервисами**: не захватывает порты, занятые настоящими сервисами.
- **Быстрая фильтрация шума**: in-memory блоклист и попытка вставки `iptables` для уменьшения повторных сканирований.
- **Админская консоль**: удобные runtime команды для статуса и аккуратной остановки.

---

## Возможности

- Конфигурируемые TCP/UDP слушатели.
- Пассивный pcap-сниффинг через gopacket (если указан интерфейс).
- Детекция сканирования: временное окно, порог по уникальным портам, SYN-rate, null-payload.
- Сигнатурные проверки для типичных RCE/стагеров и простые бинарные эвристики.
- In-memory блоклист с TTL и попыткой вставки правила в `iptables`.
- Логирование в Elasticsearch (bulk API) с fallback на файл/stdout.
- Простая stdin-консоль для управления в runtime.

---

## Ограничения

- Проект ориентирован на сбор данных и обман, а не замену полноценных IDS/IPS.
- Эвристики имеют ограничения и могут не ловить продвинутые техники уклонения.
- При большом количестве подключений/пакетов возможна перегрузка ресурсов из-за spawn'ов горутин.
- Блоклист по умолчанию временный; для долговременной блокировки нужна интеграция с FW.
- `iptables` работает только на Linux с соответствующими правами.

---

## Быстрый старт

### Сборка

```bash
go build -o honeypot main.go
```

### Пример `config.json`

```json
{
  "interface": "",
  "ports": [22, 80, 443, 12345],
  "log_file": "honeypot.log",
  "snaplen": 65535,
  "promisc": true,
  "timeout_ms": 500,
  "elastic_url": "http://127.0.0.1:9200",
  "elastic_index": "honeypot",
  "max_payload": 4096,
  "scan_window_s": 30,
  "scan_port_thresh": 10
}
```

### Запуск

```bash
./honeypot -config config.json
```

stdin-команды в runtime:
- `status` — логирует статус
- `q` / `quit` / `exit` — аккуратное завершение
- любая другая строка — попадёт в логи как `admin_cmd`

---

## Рекомендации

- Запускайте с правами, если нужно привязаться к низким портам или вставлять правила fw.
- Для работы pcap на Linux требуется доступ к захвату пакетов (CAP_NET_RAW) или запуск от root.
- Подстраивайте `scan_window_s` и `scan_port_thresh` под свою сеть.
- Для долговременного хранения и анализа интегрируйте Elasticsearch или другую систему хранения.

---

## Идеи для развития

- Активная декой-подкормка: при выявлении сканера отдавать более подробные фиктивные данные.
- Персистентный блоклист и централизованное управление списками.
- Песочница для анализа подозрительных payload'ов (в изолированной среде).
- Ограничение количества рабочих горутин и введение пулов для предотвращения исчерпания ресурсов.
- Плагины для эмуляции протоколов (HTTP, FTP, SSH) для более богатой телеметрии.

---

## Безопасность

- Не запускайте honeypot на хосте с чувствительными сервисами без полной изоляции (VM, контейнер, строгие fw-правила).
- Не пересылайте необработанные payload'ы на ненадёжные внешние системы; храните хэши и метаданные.
- Соблюдайте юридические и этические нормы при взаимодействии с внешними хостами.

---

## Лицензия

MIT License — см. файл LICENSE.